[
    {
        '$project': {
            'cve_id': '$cve.CVE_data_meta.ID',
            'metrics': {
                'vector': {
                    '$ifNull': [
                        '$impact.baseMetricV3.cvssV3.vectorString', '$impact.baseMetricV2.cvssV2.vectorString'
                    ]
                },
                'baseScore': {
                    '$ifNull': [
                        '$impact.baseMetricV3.cvssV3.baseScore', '$impact.baseMetricV2.cvssV2.baseScore'
                    ]
                },
                'impactScore': {
                    '$ifNull': [
                        '$impact.baseMetricV3.impactScore', '$impact.baseMetricV2.impactScore'
                    ]
                },
                'severity': {
                    '$ifNull': [
                        '$impact.baseMetricV3.severity', '$impact.baseMetricV2.severity'
                    ]
                }
            }
        }
    }
]
